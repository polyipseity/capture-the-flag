const{app:e,BrowserWindow:n,ipcMain:i,dialog:o}=require("electron"),path=require("path"),fs=require("fs"),{localStorage:t}=require("electron-browser-storage");let AuthWindow,DashWindow,ActiveWindow;function createAuthWindow(){ActiveWindow=AuthWindow=new n({width:1e3,height:600,resizable:!0,frame:!1,webPreferences:{nodeIntegration:!1,contextIsolation:!0,enableRemoteModule:!1,preload:path.join(__dirname,"preload.js")}}),AuthWindow.loadFile(path.join(__dirname,"templates/auth.html")),AuthWindow.on("closed",function(){AuthWindow=null})}function createDashWindow(){ActiveWindow=DashWindow=new n({width:1400,height:900,resizable:!0,frame:!1,webPreferences:{nodeIntegration:!0,contextIsolation:!1,enableRemoteModule:!0,preload:path.join(__dirname,"preload_dash.js")}}),DashWindow.loadFile(path.join(__dirname,"templates/dashboard.html")),DashWindow.on("closed",function(){DashWindow=null})}e.whenReady().then(createAuthWindow),e.on("window-all-closed",async()=>{await t.clear(),"darwin"!==process.platform&&e.quit()}),e.on("activate",()=>{null===AuthWindow&&createAuthWindow()}),i.on("login",async(e,n)=>{await t.setItem("token",n),createDashWindow(),AuthWindow.close()}),i.on("exit",async(n,i)=>{await t.clear(),e.quit()}),i.on("minimize",(e,n)=>{ActiveWindow.minimize()}),i.on("maximize",(e,n)=>{ActiveWindow.isMaximized()?ActiveWindow.unmaximize():ActiveWindow.maximize()});